<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>‚ú® –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ–π–¥–µ–Ω–∞! ‚ú®</title>
  <style>
    body {
      background: linear-gradient(120deg, #2c3e50 0%, #7f8c8d 100%);
      color: #fff;
      font-family: 'Montserrat', 'Segoe UI', Arial, sans-serif;
      text-align: center;
      padding: 0;
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      animation: fadeIn 1.4s;
    }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .magic {
      font-size: 2.2em;
      margin-bottom: 0.2em;
      letter-spacing: 0.04em;
      text-shadow: 0 0 10px #8e44ad, 0 0 30px #16a08588;
    }
    .subtitle {
      font-size: 1.2em;
      margin-bottom: 1.5em;
    }
    .sparkles {
      font-size: 3em;
      margin: 0.3em 0;
      animation: sparkle 2s infinite alternate;
    }
    @keyframes sparkle {
      from { filter: brightness(1); }
      to { filter: brightness(1.7) drop-shadow(0 0 12px #fff6); }
    }
    .tip {
      margin-top: 2em;
      color: #d3c2ff;
      font-size: 1em;
      opacity: 0.8;
    }
    .btn {
      margin-top: 2em;
      background: #6c5ce7;
      color: #fff;
      font-size: 1.1em;
      border: none;
      border-radius: 1em;
      padding: 0.7em 2.3em;
      cursor: pointer;
      box-shadow: 0 0 8px #fff5, 0 2px 12px #2d3436aa;
      transition: background 0.2s;
    }
    .btn:hover { background: #4834d4; }
  </style>
</head>
<body>
  <div class="sparkles">‚ú®</div>
  <div class="magic">–í—É–∞–ª—è! –î–≤–µ—Ä—å –≤ –≤–æ–ª—à–µ–±–Ω—ã–π –º–∏—Ä –æ—Ç–∫—Ä—ã—Ç–∞ üåå</div>
  <div class="subtitle">‚ú® –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–∞–≥–∏—á–µ—Å–∫–∏–π –∫—Ä—É–≥!<br>
    <span style="color:#fffa7a;">–§–æ–∫—É—Å–Ω–∏–∫ –ê–ª—å—Ç–∞–∏—Ä</span> –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–µ–±—è –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ –æ—Å–æ–∑–Ω–∞–Ω–Ω—ã—Ö —Å–æ—Ü—Å–µ—Ç–µ–π!
  </div>
  <button class="btn" onclick="window.close()">–ó–∞–∫—Ä—ã—Ç—å –ø–æ—Ä—Ç–∞–ª</button>
  <div class="tip">–ï—Å–ª–∏ –æ–∫–Ω–æ –Ω–µ –∑–∞–∫—Ä—ã–ª–æ—Å—å ‚Äî –ø—Ä–æ—Å—Ç–æ –∑–∞–∫—Ä–æ–π –≤–∫–ª–∞–¥–∫—É –≤—Ä—É—á–Ω—É—é.<br>–ñ–µ–ª–∞–µ–º –≤–æ–ª—à–µ–±–Ω—ã—Ö –æ—Ç–∫—Ä—ã—Ç–∏–π!</div>

  <script>
    (async () => {
      // üßô –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ URL
      const params = new URLSearchParams(window.location.search);
      const access_token = params.get('access_token');
      const user_id = params.get('user_id');
      const email = params.get('email');
      const tg_id = localStorage.getItem('tg_id'); // –ò–ª–∏ –ø–µ—Ä–µ–¥–∞–π –¥—Ä—É–≥–∏–º —Å–ø–æ—Å–æ–±–æ–º

      console.log('üîç –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:', { access_token, user_id, email, tg_id });

      if (!access_token || !user_id || !tg_id) {
        console.error('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
        return;
      }

      try {
        const res = await fetch('/auth/vk/save', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ access_token, user_id, email, tg_id })
        });
        const result = await res.json();
        console.log('‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', result);
      } catch (err) {
        console.error('üö´ –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä:', err);
      }
    })();
  </script>
</body>
</html>
